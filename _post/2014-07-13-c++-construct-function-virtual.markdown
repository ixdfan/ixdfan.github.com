---
layout: post
title: 构造函数为什么不能是虚函数
description:  
modified: 
categories: 
- C\C++
tags:
- 
---

构造函数不能使虚函数，析构函数可以是虚函数

为什么构造函数不能是虚函数呢？

每一个拥有虚成员函数的类都有一个指向虚函数表的指针。虚表指针指向虚函数表，对象通过虚函数表里存储的虚函数地址来调用虚函数。

那虚表指针在哪里初始化的呢？

当然是构造函数。

当我们通过new来创建一个对象的时候，第一步是申请需要的内存，第二步就是调用构造函数。

例如:

	A* a = new B;

首先分配一块内存，指针a指向这块内存，这块内存的最前面4个字节就是虚表指针，假如构造函数是虚函数，那么应该通过虚表指针去找到构造函数在虚表中的地址，但是此时还没有执行构造函数，这块内存也就没有初始化，那么你的虚表指针就是无效的，所以构造函数不能是虚函数。

