<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>sed总结 &#8211; 高手之路</title>
<meta name="description" content="">
<meta name="keywords" content="">


<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="sed总结">
<meta property="og:description" content="专注于linux下程序设计">
<meta property="og:url" content="http://localhost:4000/2014/05/03/shell-sed/">
<meta property="og:site_name" content="高手之路">





<link rel="canonical" href="http://localhost:4000/2014/05/03/shell-sed/">
<link href="http://localhost:4000/feed.xml" type="application/atom+xml" rel="alternate" title="高手之路 Feed">


<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Google Webfonts -->
<link href='http://fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700|PT+Serif:400,700,400italic' rel='stylesheet' type='text/css'>
<!-- For all browsers -->
<link rel="stylesheet" href="http://localhost:4000/assets/css/main.min.css">

<meta http-equiv="cleartype" content="on">

<!-- HTML5 Shiv and Media Query Support -->
<!--[if lt IE 9]>
	<script src="http://localhost:4000/assets/js/vendor/html5shiv.min.js"></script>
	<script src="http://localhost:4000/assets/js/vendor/respond.min.js"></script>
<![endif]-->

<!-- Modernizr -->
<script src="http://localhost:4000/assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://localhost:4000/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://localhost:4000/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://localhost:4000/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://localhost:4000/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://localhost:4000/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://localhost:4000/images/apple-touch-icon-144x144-precomposed.png">

</head>

<body class="post">

<!--[if lt IE 9]><div class="browser-upgrade alert alert-info">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div><![endif]-->

<div class="navigation-wrapper">
	<div class="site-name">
		<a href="http://localhost:4000">高手之路</a>
	</div><!-- /.site-name -->
	<div class="top-navigation">
		<nav role="navigation" id="site-nav" class="nav">
		    <ul>
		        
				<li><a href="http://localhost:4000" >Home</a></li>
		        
				<li><a href="http://localhost:4000/category/" >Category</a></li>
		        
				<li><a href="http://localhost:4000/posts/" >Posts</a></li>
		        
				<li><a href="http://localhost:4000/about/" >About</a></li>
		        
				<li><a href="http://localhost:4000/comment/" >Leave a message</a></li>
		        
		    </ul>
		</nav>
	</div><!-- /.top-navigation -->
</div><!-- /.navigation-wrapper -->



<div id="main" role="main">
  <div class="article-author-side">
    <img src="http://localhost:4000/images/Neo.jpg" class="bio-photo" alt="Neo bio photo"></a>
<h3>Neo</h3>
<p>每一个优秀的人,都会有一段沉默的时光. 那一段时光,是付出了很多努力,忍受孤独和寂寞,不抱怨不诉苦. 日后说起时,连自己都能被感动的日子.</p>
















  </div>
  <article>
    <div class="headline-wrap">
      <h1>sed总结</h1>
    </div><!--/ .headline-wrap -->
    <div class="article-wrap">
      <p>sed [-n] program [file-list]
sed [-n] [-f] program-file file-list</p>

<p>-n 表示除非sed使用了p指令或者是标识，否则不会将文本复制到标准输出。</p>

<pre><code>[root@ sed]# cat example 
这是第一行
这是第二行
第三行
第四行,文件的中部
这是第五行
六行
第七行
这是第八行

[root@ sed]# sed -n '2,8 p' example
这是第二行
第三行
第四行,文件的中部
这是第五行
六行
第七行
这是第八行
</code></pre>

<h4>地址作用</h4>

<p>通过地址来确定需要处理的数据行，地址可以通过数字正则表达式或二者结合的方式。</p>

<p>当地址由数字构成的时候，数字表示行号，二行号作为地址可以用来选择某一行，作为一个特列，符号$表示出入中的最后一行。</p>

<p>用逗号分隔的两个行号表示以这两行为起止的行的范围(包括行数表示的那两行)。</p>

<p>正则表达式作为地址可以用来选择那些包含与正则表达式相匹配的字符串的行。</p>

<p>如果没有地址，sed将会选择所有的行</p>

<h4>指令</h4>

<pre><code>d   删除指令

n   下一条指令

a   追加指令

i   插入指令

c   修改指令

s   替换指令

p   打印指令

w file  写指令

r file  读取指令

q   退出




[root@ sed]# sed '2,6 d' example
这是第一行
第七行
这是第八行
</code></pre>

<h5>追加指令</h5>

<p>a指令会在当前选择的行之后插入一行或多行文本。如果a指令前有两个地址，则会在每个地址之后添加文本</p>

<h5>注意:</h5>

<p>除最后一行外，所有添加的文本的每一行都必须以反斜杠结尾，反斜杠用于指袋行末的换行符。没有反斜杠结尾的行被是做要添加到文本的末尾</p>

<pre><code>#filename:append
#分贝在第四行和最后一行添加分隔符

4 a\
----------------    #指令的最后一行，所以不用添加\
$ a\
----------------


[root@ sed]# sed -f append  example
这是第一行
这是第二行
第三行
第四行,文件的中部
----------------
这是第五行
六行
第七行
这是第八行
----------------
</code></pre>

<h5>打印指令</h5>

<pre><code>[root@ sed]# sed '/六/p' example
这是第一行
这是第二行
第三行
第四行,文件的中部
这是第五行
六行
六行
第七行
这是第八行


由于没有使用-n选项，所有的行都被显示输出
</code></pre>

<h5>注意:</h5>

<p>除非制定了-n否则sed将会在标准输出上打印所有的行，无论是否满足条件。使用-n选项后，sed仅仅在标准输出上打印满足的行。例如被p指令选定的行。</p>

<pre><code>#!/bin/sed -f
#filename:change
#将第三行的内容修改为aaaaaaaaa
#将第四行的内容修改为bbbbbbbbb
#将第五行的内容修改为ccccccccc
#
3,5 c\
aaaaaaaa\
bbbbbbbb\
cccccccc 


[root@ sed]# ./change example
这是第一行
这是第二行
aaaaaaaa
bbbbbbbb
cccccccc
六行
第七行
这是第八行
</code></pre>

<h5>替换指令</h5>

<p>替换指令与vim中的非常相似</p>

<pre><code>[address [,address] ] s/pattern/replacement-string/[g][p][w file]
</code></pre>

<p>g标识:sed的s指令对选定行的所有匹配字符串进行替换</p>

<p>p标识:将所有应用了替换操作的行输出到标准输出</p>

<p>w标识:他将输出送入file指定的文件中</p>

<pre><code>[root@ sed]# sed -n 's/这是/This is/p' example
This is第一行
This is第二行
This is第五行
This is第八行


[root@ sed]# sed 's/这是/This is/w temp' example
This is第一行
This is第二行
第三行
第四行,文件的中部
This is第五行
六行
第七行
This is第八行

[root@ sed]# cat temp
This is第一行
This is第二行
This is第五行
This is第八行
[root@ sed]#



#!/bin/bash
#filename:

for file    #默认以命令行参数作为in的对象
do
    echo $file
    cp $file ftemp
    #将ftemp中所有的is替换为IS，
    #MY替换为my，PAPER替换为paper
    sed 's/is/IS/g
         s/MY/my/g
         s/PAPER/paper/g
        '  ftemp &gt; $file
done 
rm -rf ftemp
</code></pre>

<h5>插入指令</h5>

<p>插入指令是将文本添加到选定行之前</p>

<pre><code>/第/ i\
-----下一行有"第"字出现------
</code></pre>

<h5>下一条指令</h5>

<p>n指令输出当前选择的行，然后从输入中读取下一行，并且从sed程序中的下一条指令开始对新读入的行进行处理</p>

<pre><code>#使用n指令跳过文件中的第3行
#表示对如果是第三行则使用n指令，然后使用p指令，其他行直接使用p指令
[root@ sed]# cat next
3n
p
[root@ sed]# sed -n -f next example
这是第一行
这是第二行
第四行,文件的中部
这是第五行
六行
第七行
这是第八行
</code></pre>

<h5>文件读入指令</h5>

<p>r指令读出指定文件的内容并添加到选定的行之后</p>

<pre><code>#在文件example中出现'六'的行下方读入文件example
[root@ sed]# sed '/六/r next' example
这是第一行
这是第二行
第三行
第四行,文件的中部
这是第五行
六行
3 n
p
第七行
这是第八行
</code></pre>

<h5>控制结构</h5>

<p>!取反操作:使得sed后面与其同一行的指令作用于没有被该指令选择的每一行地址上</p>

<p>3!d:删除除了第三行以外的所有的行
3,6 !w file :将除3-6行以外所有额行写入到file中</p>

<h5>Hold和Pattern</h5>

<p>sed有两个缓冲区，Pattern和Hold区，所有的命令都是工作在Pattern区。Pattern区保存着sed刚刚从输入中读取的行。</p>

<p>Hold作为临时缓冲区，可以在操作Pattern时候用来暂存数据。将数据放入Hold区之前内容为空</p>

<p>Pattern和Hold之间传送数据的指令:</p>

<p>g   将Hold区中的内容复制到Pattern中，Pattern中原来的内容将会丢失</p>

<p>G   将一个换行符和Hold区中的内容追加到Pattern区的内容之后</p>

<p>h   将Pattern区的内容复制到Hold区，Hold中原来的数据会丢失</p>

<p>H   将一个换行符和Pattern区中的内容附加到Hold区中的内容之后</p>

<p>x   交换Pattern和Hold缓冲区的内容</p>

<pre><code>[root@ sed]# sed 'G' example
这是第一行

这是第二行

第三行

第四行,文件的中部

这是第五行

六行

第七行

这是第八行

[root@ sed]# 




[root@ sed]# cat pandh
2,$G
h
$!d
[root@ sed]# sed -f pandh example
这是第八行
第七行
六行
这是第五行
第四行,文件的中部
第三行
这是第二行
这是第一行
[root@ sed]#
</code></pre>

<p>将Pattern和Hold区域配合使用，反序输出文件example中的内容</p>

<p>$表示最后一行</p>

<p>2,$表示2到最后一行</p>

<p>!表示取反</p>

<p>$!表示除最后一行的其他行</p>

<p>具体的步骤:</p>

<p>1).sed将输入的第一行("这是第一行")内容读入到Pattern中</p>

<p>指令2,$G不会处理第一行，G只会处理2到最后一行</p>

<p>h指令将第一行从Pattern复制到Hold</p>

<p>$!d删除了Pattern中的内容，所以Pattern中没有任何内容，所以sed什么也不显示</p>

<p>2).sed将输入中的第二行("这是第二行")读入到Pattern</p>

<p>指令2,$G会将Hold中的内容("这是第一行"),添加到Pattern，此时Pattern中的内容是"这是第二行\n这是第一行"</p>

<p>指令h将Pattern中的内容复制到Hold</p>

<p>$!d删除了输入中的第二行内容，所以sed什么也不显示。</p>

      <hr />
      <footer role="contentinfo">
        <div class="article-author-bottom">
          <img src="http://localhost:4000/images/Neo.jpg" class="bio-photo" alt="Neo bio photo"></a>
<h3>Neo</h3>
<p>每一个优秀的人,都会有一段沉默的时光. 那一段时光,是付出了很多努力,忍受孤独和寂寞,不抱怨不诉苦. 日后说起时,连自己都能被感动的日子.</p>
















        </div>
        <p class="byline"><strong>sed总结</strong> was published on <time datetime="2014-05-03T00:00:00+00:00">May 03, 2014</time> by <a href="http://localhost:4000/about" title="About Neo">Neo</a>.</p>
      </footer>
    </div><!-- /.article-wrap -->
  </article>
</div><!-- /#main -->

<div class="footer-wrap">
  <div class="related-articles">
  <h4>You might also enjoy <small class="pull-right">(<a href="http://localhost:4000/posts/">View all posts</a>)</small></h4>
    <ul>
    
      <li><a href="http://localhost:4000/2014/05/10/sed-bat-change-file-var-name/" title="sed批量修改文件中的名字">sed批量修改文件中的名字</a></li>
    
      <li><a href="http://localhost:4000/2014/05/09/stl-use-map/" title="map的使用">map的使用</a></li>
    
      <li><a href="http://localhost:4000/2014/05/08/mysql-include-header/" title="将mysql的头文件加入自动搜索">将mysql的头文件加入自动搜索</a></li>
    
    </ul>
    <hr />
        <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'ucshellcom'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    
  </div><!-- /.related-articles -->
  <footer>
    <br></br>
<br></br>
<span>&copy; 2013 - 2014 高手之路 ucshell.com , All Rights Reserved.   </span>

  </footer>
</div><!-- /.footer-wrap -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://localhost:4000/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="http://localhost:4000/assets/js/scripts.min.js"></script>
	        

</body>
</html>