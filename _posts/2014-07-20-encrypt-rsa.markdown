---
layout: post
title: RSA加密算法原理
description:  
modified: 
categories: 
- 加密解密
tags:
- 
---

### RSA算法要求:
#### 1.明文M经过加密得到密文C: C=M^e mod n
#### 2.密文C经过解密得到明文M: C^d mod n = M
#### 3.签名过程: s =  M^d mod n
#### 4.签名验证过程 M = s^e mod n

也就是要求
	
	C^d mod n = (M^e mod n)^d mod n = M^ed mod n = M

以上等式必须成立，即必须存在e、d、n使得M^ed mod n = M成立

#### 确定d、e、n

#####确定n
随机选定两个大**素数**p、q，注意:p，q都是素数
计算公钥和私钥的公共模数n,n = pq 

#####确定e
计算模数n的欧拉函数 φ(n) .
选定一个正整数e, 使1 < e < φ(n) , 且**e与φ(n)互质**.

#####确定d
计算d, 满足 ed ≡ 1 (mod φ(n) ), (k为某个正整数).

	
###n与e决定公钥, n与d决定私钥.


#### 加密与解密
n与e组成公匙,加密需要使用公匙

假设M明文为65,同时n、d、e分别是3233、2753和17,则

	6517 ≡ 2790 (mod 3233)

计算出C=2790，解密需要私匙
	
	27902753 ≡ 65 (mod 3233)
	
解密成功

-------------------------------------------------------------------------------

#### 模运算

	(a + b) mod m = ((a mod m) + (b mod m)) mod m
	(a - b) mod m = ((a mod m) - (b mod m)) mod m
	(a * b) mod m = ((a mod m) * (b mod m)) mod m
	(a * (b + c)) mod m = (((a*b) mod m) + ((a*c) mod m)) mod m
	
#### 欧拉函数
对于任意正整数n，请问在小于等于n的正整数之中，有多少个与n构成互质关系?

计算这个问题的方法就是欧拉函数使用φ(n)表示

例如1-8之间与8形成互质关系的数字有1,3,5,7，所以φ(8) = 4;

欧拉函数有几种不同的情况需要讨论

##### 情况一
	n = 1,则φ(n) = 1,因为1与任何数都构成互质关系

##### 情况二
对于给定的一个素数p
		
	φ(p) = p -1。

##### 情况三
p^k 的欧拉函数,对于正整数 n = pk 

	φ(n) = p^k - p^(k -1)

##### 情况四
假设 p, q是两个互质的正整数，则 p * q 的欧拉函数为

	φ(p*q) = φ(p) * φ(q) ， gcd(p, q) = 1

如果p，q有都是素数的话

	φ(p*q) = (p-1)(q-1)

#### 欧拉定理
> 对于任何两个互素的整数a和n有
>    a^φ(n) ≡ 1 mod n

####补充:

模反元素:

	如果两个

	a ≡ b  (mod n )

这样的式子成为同余式,含义是a和b除以n余数相同


#### 证明: 为什么可以使用私匙解密

	C = M^e mod n ≡ M^ed mod n ≡ M^(1 mod φ(n)) mod n ≡ M^(kφ(n)+1) mod n

分两种情况证明:

1.gcd(M, n) = 1即M与n互素，此时，由欧拉定理可得
	
	M^φ(n) ≡ 1 mod n

	M^kφ(n) ≡ 1 mod n

	M^(kφ(n)+1) = M^kφ(n) * M  ≡ M mod n

	所以
		C^d mod n = M

2.gcd(M, n) != 1,由于n=pq,所以M是p的倍数或是q的倍数，假设m = cp,c为小于q的正整数，则gcd(M, q) = 1必然成立，否则M也是q的倍数，从而也是pq的倍数，与M<n=pq矛盾。
	
	gcd(M, q) = 1，由欧拉定理得:

	M^φ(q) ≡ 1 mod q

	所以
		M^kφ(q) ≡ 1 mod q

	因为
		φ(q) = q - 1

	所以
		 M^k(q-1) ≡ 1 mod q

	所以
		 M^k(q-1)(p-1) ≡ 1 mod q
	即
		M^kφ(n) ≡ 1 mod q
	
	因此存在一个整数使得
		 M^kφ(n) = 1 + rq;

	两边同时乘以M = cp得
		M^(kφ(n)+1) = cp + rqcp

	因为n = pq
	所以
		M^(kφ(n)+1) = M + rcn
	即
		M^(kφ(n)+1) ≡ M mod n

	所以
		C^d mod n = M


